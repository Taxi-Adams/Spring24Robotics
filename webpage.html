<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Joystick</title>
  <style>
    #joystick-container {
      position: fixed;
      top: 50%;
      left: 50%;
      background-color: #B4B4B8;
      margin-top: -250px;
      margin-left: -150px;
      width: 300px;
      height: 300px;
      border-radius: 50%;
    }

    #joystick-handle {
      position:relative;
      top: 100px;
      left: 100px;
      width: 100px;
      height: 100px;
      background-color: red;
      border-radius: 50%;
      cursor: grab;
    }
    
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }

    label {
      display: block;
      margin-bottom: 10px;
    }
    
    #sliders {
      position: fixed;
      top: 65%;
      left: 50%;
      margin-top: -20px;
      margin-left: -75px;
      width: 300px;
      height: 300px;
    }
  </style>
   
  </head>
<body>
<div id="joystick-container">
  <div id="joystick-handle"></div>
</div>
<div id = "sliders">
  <label for="waistSlider">Waist:</label>
  <input type="range" id="waistSlider" name="waist" min="0" max="100" value="50">
  <label for="tiltSlider">HeadTilt:</label>
  <input type="range" id="tiltSlider" name="tilt" min="0" max="100" value="50">
  <label for="panSlider">HeadPan:</label>
  <input type="range" id="panSlider" name="pan" min="0" max="100" value="50">
</div>

<script>
  const joystickContainer = document.getElementById('joystick-container');
  const joystickHandle = document.getElementById('joystick-handle');

  let isDragging = false;

  joystickHandle.addEventListener('mousedown', startDrag);
  window.addEventListener('mousemove', drag);
  window.addEventListener('mouseup', stopDrag);

  joystickHandle.addEventListener('touchstart', startDrag, { passive: false });
  window.addEventListener('touchmove', drag, { passive: false });
  window.addEventListener('touchend', stopDrag, { passive: false });

  function startDrag(e) {
    isDragging = true;
    e.preventDefault();
  }

  function drag(e) {
    if (isDragging) {
      const containerRect = joystickContainer.getBoundingClientRect();
      const handleSize = joystickHandle.offsetWidth;
      
      let x = (e.clientX - 112.5) - containerRect.left - handleSize / 2;
      let y = (e.clientY - 112.5) - containerRect.top - handleSize / 2;

      x = Math.max(-112.5, Math.min(x, containerRect.width - handleSize));
      y = Math.max(-112.5, Math.min(y, containerRect.height - handleSize));
      if (x > 112.5) {
        x = 112.5;
      }
      if (y > 112.5) {
        y = 112.5;
      }
      
      joystickHandle.style.transform = `translate(${x}px, ${y}px)`;
      console.log(`x=${Math.floor(x)}, Y=${Math.floor(y)}`);
    }
  }
  function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }
  function stopDrag(e) {
    isDragging = false;
    const containerRect = joystickContainer.getBoundingClientRect();
    const handleSize = joystickHandle.offsetWidth;
    let y = (e.clientY - 112.5) - containerRect.top - handleSize / 2;
    y = Math.max(-112.5, Math.min(y, containerRect.height - handleSize));
    if (y > 112.5) {
        y = 112.5;
      }
    console.log(`THIS IS THE Y VALUE AT STOP: ${Math.floor(y)}`);
    joystickHandle.style.transform = 'translate(0, 0)';
  }

  // Optional: You can add JavaScript to handle slider value changes
  const waistSlider = document.getElementById('waistSlider');
  const tiltSlider = document.getElementById('tiltSlider');
  const panSlider = document.getElementById('panSlider');

  waistSlider.addEventListener('input', () => {
    const waistValue = waistSlider.value;
    console.log(`Waist value: ${waistValue}`);
    // You can perform additional actions based on the slider value
  });

  tiltSlider.addEventListener('input', () => {
    const tiltValue = tiltSlider.value;
    console.log(`Waist value: ${tiltValue}`);
    // You can perform additional actions based on the slider value
  });

  panSlider.addEventListener('input', () => {
    const panValue = panSlider.value;
    console.log(`Waist value: ${panValue}`);
    // You can perform additional actions based on the slider value
  });  


</script>

</body>
</html>
